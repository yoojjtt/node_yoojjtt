<!doctype html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">


    <!-- Bootstrap -->
    <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet" media="screen">
    <link href="bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet" media="screen">
    <link href="vendors/easypiechart/jquery.easy-pie-chart.css" rel="stylesheet" media="screen">
    <link href="assets/styles.css" rel="stylesheet" media="screen">
    <link href="assets/DT_bootstrap.css" rel="stylesheet" media="screen">
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <script src="vendors/modernizr-2.6.2-respond-1.1.0.min.js"></script>

    <title>main</title>


</head>
<body>



<!-- Modal -->
<div class="modal fade" id="AdminModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">Title</h4>
            </div>
            <div class="modal-body">

                <iframe src=""
                        name="iframe_modal"
                        id="iframe_modal"
                        width="100%" height="100%"
                        frameborder="0"
                        scrolling="no">
                </iframe>

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal" onclick="_modal_close()">닫기</button>
            </div>
        </div>
    </div>
</div>




<!-- top_nav_bar-->

<div id="fixed_top" class="navbar navbar-fixed-top">
    <div class="navbar-inner">
        <div class="container-fluid">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse"> <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>
            <div style="display:none" id="com_info" class="brand"></div>
            <div class="nav-collapse collapse" data-role="navbar">
                <ul class="nav pull-right">
                    <li class="dropdown">
                        <a href="/" role="button" class="dropdown-toggle" data-toggle="dropdown"> <span id= "user_name"></span> <i class="icon-user"></i>
                            <strong id="com_num" hidden style="color:black;"></strong>
                        </a>
                        <ul class="dropdown-menu">
                            <li>
                                <a tabindex="-1" onClick="navbar_move('profile');" href="#">Profile</a>
                            </li>
                            <li class="divider"></li>

                            <li>
                                <a style="color:red;"onClick="logout()" tabindex="-1" href="#">Logout</a>
                            </li>
                        </ul>
                    </li>
                </ul>
                <ul id="top_navbar" class="nav" >
                    <li id="company_management" class="active">
                        <a onClick="navbar_move('main');" href="#">회사관리</a>
                    </li>
                    <li id="hyunjang_management" class="dropdown">
                        <a onClick="navbar_move('hyunjang');" href="#">현장관리</a>
                    </li>
                    <li id="finance_management" class="dropdown">
                        <a onClick="navbar_move('finance');" href="#">재무관리</a>
                    </li>
                </ul>
            </div>
            <!--/.nav-collapse -->
        </div>
    </div>
</div>


<!-- END top_nav_bar-->



<!-- contnents -->
 <div class="contents">
    <iframe name="iframe_contents"
            id="iframe_contents"

            frameborder=0"
            scrolling="no"
            class="myFrame">
    </iframe>
 </div>
<!-- contents -->


<!--/.fluid-container-->
<script src="vendors/jquery-1.9.1.min.js"></script>
<script src="bootstrap/js/bootstrap.min.js"></script>
<script src="vendors/easypiechart/jquery.easy-pie-chart.js"></script>
<script src="assets/scripts.js"></script>

<script src="js/my_js/_DB_query.js"></script>
<script src="js/my_js/_static.js"></script>

<script src="js/my_js/_auth.js"></script>
<script src="js/my_js/UI.js"></script>
<script>

    /* page 초기 ------------*/
    $(function() {


        if (email == false) {  //cookie  없으면 로그인페이지로 redirects
            location.href = "/pages/login.html";
            $("#fixed_top").hide();

        } else { // 로그인 성공하면,

            $(".navbar navbar-fixed-top").show();
            $('#user_name').append(type + ": " + email);  //메인화면 우측 상단 사용자 이름
            $('#com_info').append(company_no); // 메인화면 좌측 상단 로고
            if(type == '대표'){
                navbar_move("main"); //main 페이지를 로드하면서 페이지 시작
                $('#AdminModal').modal('toggle');
                modalOpen('notification', '공지사항', 'auto', 500, -1);
            }

            if(type == '소장'){
                //$('#hyunjang_management').trigger('click');
                navbar_move("hyunjang");
                $('#company_management').css('display', 'none');
                $('#finance_management').css('display', 'none');
            }
            if(type == '회계'){
                navbar_move("finance");
                $('#company_management').css('display', 'none');
                $('#hyunjang_management').css('display', 'none');
            }





        }

    });




    function logout(){  //logout, cookie, session 삭제
        auth.logout_process();
    }

    function navbar_move(loadpage){ // nav bar click할 경우
        var company_num = $('#com_num').text();
        _callFrame("/pages/"+loadpage+".html", company_num, 'R');
    }

    function _callFrame(loadPage, num, gubun_val){  // navbar에서 다른 탭 누를시 contents 페이지 변경
            //alert(num);
            document.getElementById('iframe_contents').src = loadPage;
            document.getElementById('iframe_contents').onload = function() {
                var target = document.getElementById('iframe_contents').contentWindow;

                //target.comInfo(num, companyName, gubun_val);  //TODO companyName 없앨 것 !!
            };

    }
    function modalOpen(_pageName, _title, _width, _height, _value1, _value2) {

        $('#myModalLabel').html(_title);
        $("#AdminModal").modal();



        document.getElementById('iframe_modal').src = '/pages/'+_pageName+".html";
        document.getElementById('iframe_modal').onload = function() {
            var target = document.getElementById('iframe_modal').contentWindow;
            var width = $(target).width();

            if(_pageName=="notification") {
                $('.modal-footer').css('display', 'none');
                $('.modal-header .close').css('display', 'none');
                $('#iframe_modal').css('height', 300);
            }
            $('.modal-dialog').css('width', _width);
            $('#iframe_modal').css('height', _height);
            $('.modal-footer').css('display', 'none');

            target.hyunjang_Info(_value1);
        };

    }




</script>



<script src="vendors/datatables/js/jquery.dataTables.min.js"></script>  <!-- data를 부르고 난뒤에 dt 만들것 -->
<script src="assets/DT_bootstrap.js"></script>

</body>
</html>